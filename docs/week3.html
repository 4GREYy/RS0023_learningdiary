<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>learningdirary - week3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./week4.html" rel="next">
<link href="./week2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./week3.html">week3</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">learningdirary</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">week3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">week4</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week5</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week6</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">week7</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">week8</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary">1 Summary</a>
  <ul class="collapse">
  <li><a href="#atmospheric-correction" id="toc-atmospheric-correction" class="nav-link" data-scroll-target="#atmospheric-correction">1.1 Atmospheric correction</a></li>
  <li><a href="#merging-images" id="toc-merging-images" class="nav-link" data-scroll-target="#merging-images">1.2 Merging images</a></li>
  <li><a href="#enhancement" id="toc-enhancement" class="nav-link" data-scroll-target="#enhancement">1.3 Enhancement</a></li>
  <li><a href="#ratio-analysis" id="toc-ratio-analysis" class="nav-link" data-scroll-target="#ratio-analysis">1.3.1 Ratio analysis</a></li>
  <li><a href="#filtering" id="toc-filtering" class="nav-link" data-scroll-target="#filtering">1.3.2 Filtering</a></li>
  <li><a href="#texture-analysis" id="toc-texture-analysis" class="nav-link" data-scroll-target="#texture-analysis">1.3.3 Texture Analysis</a></li>
  <li><a href="#data-fusion" id="toc-data-fusion" class="nav-link" data-scroll-target="#data-fusion">1.3.4 Data fusion</a></li>
  <li><a href="#principal-component-analysis-pca" id="toc-principal-component-analysis-pca" class="nav-link" data-scroll-target="#principal-component-analysis-pca">1.3.5 Principal Component Analysis (PCA)</a></li>
  </ul></li>
  <li><a href="#application" id="toc-application" class="nav-link" data-scroll-target="#application">2 Application</a></li>
  <li><a href="#personal-reflections" id="toc-personal-reflections" class="nav-link" data-scroll-target="#personal-reflections">3 Personal Reflections</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">week3</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This week covers the key steps in remote sensing data processing analysis such as atmospheric corrections, merging images and enhancements that work together to improve the usability of the data and the accuracy of the analysis.</p>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">1 Summary</h2>
<section id="atmospheric-correction" class="level3">
<h3 class="anchored" data-anchor-id="atmospheric-correction">1.1 Atmospheric correction</h3>
<p>Atmospheric correction is the process of correcting satellite images for the effects of atmospheric scattering and absorption. This step is essential to improve the accuracy of surface reflectance data. In GEE, many satellite datasets have already been preprocessed to include atmospheric correction, such as the Landsat and Sentinel series. For data that have not been pre-processed, GEE provides tools and algorithms to implement atmospheric corrections, for example using the 6S model (Second Simulation of the Satellite Signal in the Solar Spectrum) or the DOS (Dark Object Subtraction) method.</p>
</section>
<section id="merging-images" class="level3">
<h3 class="anchored" data-anchor-id="merging-images">1.2 Merging images</h3>
<p>Merging images (sometimes called mosaicing or fusion) is the process of combining multiple images into a single image, which is useful when working with large regions or integrating data from different points in time. In GEE, images can be merged using methods such as mosaic() or median(). mosaic() method superimposes images in the order they appear in the set, while median() can take the median value of each pixel, which is very effective in removing clouds and cloud shadows.</p>
</section>
<section id="enhancement" class="level3">
<h3 class="anchored" data-anchor-id="enhancement">1.3 Enhancement</h3>
<p>Image enhancement is a set of techniques to improve the quality of an image by adjusting the contrast, brightness, colour etc. of the image. In GEE, the visualize() function can be used to adjust the display parameters of an image, such as setting the minimum and maximum values to change the contrast, or creating a false-colour image by selecting a specific combination of bands. Furthermore, in remote sensing image processing, enhancement is not limited to adjusting contrast and brightness, but also includes a range of advanced techniques such as ratio analysis, filtering, texture analysis, data fusion and principal component analysis (PCA). These techniques can improve the interpretability and application value of image data from different perspectives.</p>
</section>
<section id="ratio-analysis" class="level3">
<h3 class="anchored" data-anchor-id="ratio-analysis">1.3.1 Ratio analysis</h3>
<p>Ratio analysis, in which the ratio of one band to another is used as the basis for analysis, is particularly useful in highlighting specific surface features and reducing the effects of illumination changes. For example, in vegetation analysis, the ratio of the red and near-infrared bands can be used to emphasise vegetated areas. In GEE, ratio analyses can be achieved by direct manipulation of the bands.</p>
</section>
<section id="filtering" class="level3">
<h3 class="anchored" data-anchor-id="filtering">1.3.2 Filtering</h3>
<p>Filtering refers to the application of various spatial or temporal filters to smooth, enhance or suppress specific features in an image. In GEE, inbuilt functions such as median filter, high pass and low pass filters can be used to spatially filter a collection of images to remove noise or emphasise features such as edges.</p>
</section>
<section id="texture-analysis" class="level3">
<h3 class="anchored" data-anchor-id="texture-analysis">1.3.3 Texture Analysis</h3>
<p>Texture analysis involves evaluating the roughness, smoothness or other textural features of patterns in an image. This is very effective in distinguishing areas with different surface features such as urban and natural landscapes.Methods such as grey level covariance matrix (GLCM) can be used in GEE to compute and analyse the texture features of an image.</p>
</section>
<section id="data-fusion" class="level3">
<h3 class="anchored" data-anchor-id="data-fusion">1.3.4 Data fusion</h3>
<p>Data fusion is the process of combining data from different sources (e.g., from different sensors or at different times) to improve resolution or to reduce gaps in the data (e.g., cloud coverage).GEE provides several data fusion techniques, such as pixel-level fusion, feature-level fusion, and decision-level fusion, which enable users to perform comprehensive analyses using data from multiple sources.</p>
</section>
<section id="principal-component-analysis-pca" class="level3">
<h3 class="anchored" data-anchor-id="principal-component-analysis-pca">1.3.5 Principal Component Analysis (PCA)</h3>
<p>PCA is a statistical technique that reduces the dimensionality of data by transforming the data to a new coordinate system while retaining as much variability as possible in the original data. In remote sensing image analysis, PCA is commonly used to enhance contrast in images, remove redundant information with high correlation, and compress data. Although GEE does not provide PCA functions directly, users can implement PCA with custom functions or use other statistical analysis tools on GEE to perform similar data dimensionality reduction and feature extraction.</p>
</section>
</section>
<section id="application" class="level2">
<h2 class="anchored" data-anchor-id="application">2 Application</h2>
<p>Below I will describe specific applications of the four different analyses:</p>
<p>A. Application of ratio analysis: vegetation monitoring</p>
<p>In vegetation health and growth monitoring, ratio analysis is often used to highlight differences between vegetation and other surface types. For example, the normalised vegetation index (NDVI), which is obtained by calculating the ratio of the near-infrared band to the red band, is a useful indicator of the health and biomass of vegetation. This method is widely used in agricultural management, forest monitoring and ecological research.</p>
<p>For example, Bajocco, S. et al.(2022)’s study explores the relationship between the Normalized Difference Vegetation Index (NDVI) and the Leaf Area Index (LAI) in agricultural settings. It aims to develop a comprehensive library of conversion equations for estimating LAI from NDVI data, based on empirical relationships established through extensive literature review and analysis.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pic/appndvi.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Leaf area index (LAI) seasonal profile of the case studies, computed from normalized difference vegetation index (NDVI, dots) values according to the equations derived from the following combinations of attributes: (top) crop- and biome-specific equations; (middle) crop- and spatial resolution-specific equations; (bottom) biome- and spatial resolution-specific equations. The grey shadows indicate the 5–95th (light grey) and the 25–75th percentile (dark grey) of the LAI values obtained from the equations considered.</figcaption>
</figure>
</div>
<p>B. Filtering Applications: Urban Planning</p>
<p>In urban planning and building identification, filtering techniques can help remove image noise and improve the clarity of building edges. By applying spatial filters, such as edge enhancement filters, city layouts and road networks can be identified more clearly to support urban planning and traffic management.</p>
<p>C. Texture Analysis Application: Land Use Classification</p>
<p>Texture analysis is able to extract texture information from images, which can be used to distinguish areas with different surface texture characteristics. This is particularly useful in land use and land cover classification, such as distinguishing between urban built-up areas, agricultural land and forests. Texture features increase the accuracy of classification, especially in high-resolution satellite image analysis.</p>
<p>This paper by Przemysław Kupidura(2019) investigates the effectiveness of various texture analysis methods, including the gray level co-occurrence matrix (GLCM), Laplace filters, and granulometric analysis, for improving land use/cover classification.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pic/apptex.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Subsets of images of selected classification variants (test image 3: Sentinel-2): (a) spectral, (b) spectral + gran10, (c) spectral + GLCM7, (d) spectral+ Laplacian, (e) original satellite image.</figcaption>
</figure>
</div>
<p>D. Data fusion applications: improving image resolution</p>
<p>Data fusion techniques, such as band fusion (Pansharpening), can combine high-resolution panchromatic images with low-resolution multispectral images to produce higher-resolution images. This is critical for applications such as detailed map production, fine agricultural monitoring and urban environmental assessment, as it provides richer surface information.</p>
<p>This study presents a convolutional neural network (CNN) based framework for pansharpening, which is a data fusion technique aimed at enhancing the spatial resolution of multispectral images using high-resolution panchromatic images(Ciotola, M. &amp; Scarpa, G., 2023).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pic/appcnn.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Pansharpening results on the WorldView-3 Adelaide image (crop C).</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pic/appcnn1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Pansharpening results on the WorldView-2 Washington image (crop B).</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pic/appcnn2.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Pansharpening results on the GeoEye-1 Washington image (crop B).</figcaption>
</figure>
</div>
</section>
<section id="personal-reflections" class="level2">
<h2 class="anchored" data-anchor-id="personal-reflections">3 Personal Reflections</h2>
<p>The application of these advanced image enhancement and analysis techniques on the GEE platform greatly expands the range of applications of remote sensing data, supporting decision-making and scientific research in a variety of fields, from ecological monitoring to urban planning.</p>
<p>These remote sensing processing and analysing methods were my first contact, and the actual operation gave me a lot of new experiences, although I also encountered a lot of difficulties in the process, especially the PCA running process is relatively slow. However, the novelty of the experience makes me look forward to the learning content in the following weeks.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./week2.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Week2</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./week4.html" class="pagination-link">
        <span class="nav-page-text">week4</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>